<!DOCTYPE html><html lang="en"> <head><meta charset="utf-8"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="viewport" content="width=device-width"><meta name="generator" content="Astro v5.16.9"><title>Nasm64</title></head> <body> <h1>Nasm64</h1>  <p><em>64-bit assembler</em></p> <p>2026-01-16</p> <p>Written by: xiaobin</p> <pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>git clone https://github.com/ShiftMediaProject/VSNASM.git</span></span></code></pre>
<ul>
<li>x64 Native Tools Command Prompt for VS 2022</li>
</ul>
<blockquote>
<p>Run command prompt as administrator</p>
</blockquote>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="cmd"><code><span class="line"><span style="color:#E1E4E8">cd \</span></span>
<span class="line"><span style="color:#E1E4E8">cd VSNASM</span></span>
<span class="line"><span style="color:#E1E4E8">install_script.bat</span></span></code></pre>
<h2 id="project">project</h2>
<ul>
<li>set compile<br>
Project -> Build Customizations<br>
checked:</li>
</ul>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>nasm(.targets, .props)</span></span></code></pre>
<ul>
<li>set entry point<br>
Linker -> Advanced</li>
</ul>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>Entry Point: main</span></span></code></pre>
<h3 id="compile">compile</h3>
<ul>
<li>manual:</li>
</ul>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>nasm -f win64 hello_floats.asm</span></span></code></pre>
<ul>
<li>auto:<br>
In the Solution Explorer, select the asm file, then right-click and select Compile.</li>
</ul>
<h3 id="generate-exe">Generate exe</h3>
<p>run “x64 Native Tools Command Prompt for VS 2022”</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>link hello_floats.obj /subsystem:console /out:hello6.exe kernel32.lib msvcrt.lib ucrt.lib legacy_stdio_definitions.lib</span></span></code></pre>
<h3 id="hello_floatsasm">hello_floats.asm</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>; Copyright 2019 Siew Yi Liang.</span></span>
<span class="line"><span>; </span></span>
<span class="line"><span>default rel</span></span>
<span class="line"><span>bits 64</span></span>
<span class="line"><span></span></span>
<span class="line"><span>segment .data</span></span>
<span class="line"><span>    a dd 3.25</span></span>
<span class="line"><span>    b dd 10.53</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    fmt db 'result is: %f', 0xa, 0</span></span>
<span class="line"><span></span></span>
<span class="line"><span>segment .text</span></span>
<span class="line"><span>global main</span></span>
<span class="line"><span>extern _CRT_INIT</span></span>
<span class="line"><span>extern ExitProcess</span></span>
<span class="line"><span>extern printf</span></span>
<span class="line"><span></span></span>
<span class="line"><span>main:</span></span>
<span class="line"><span>    call _CRT_INIT                 ; Needed since our entry point is not _DllMainCRTStartup. See https://msdn.microsoft.com/en-us/library/708by912.aspx</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    push    rbp</span></span>
<span class="line"><span>    mov    rbp, rsp</span></span>
<span class="line"><span>    sub    rsp, 32</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    movss    xmm0, [a]             ; Load a</span></span>
<span class="line"><span>    movss    xmm1, [b]             ; Load b</span></span>
<span class="line"><span>    vaddss    xmm2, xmm0, xmm1      ; xmm2 = xmm1 + xmm2</span></span>
<span class="line"><span>    lea    rcx, [fmt]</span></span>
<span class="line"><span>    movss    xmm1, xmm2</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    ; Remember, %f actually expects a double, so we need to convert the float to double</span></span>
<span class="line"><span>    cvtss2sd    xmm1, xmm1</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    ; Also remember: floats are passed in xmm registers, but printf wants a</span></span>
<span class="line"><span>    ; double! This is an aggregate so it's passed in RDX instead.</span></span>
<span class="line"><span>    movq    rdx, xmm1</span></span>
<span class="line"><span>    call    printf</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    xor eax, eax                ; return 0</span></span>
<span class="line"><span>    call ExitProcess</span></span>
<span class="line"><span></span></span></code></pre>
<h2 id="ref">Ref</h2>
<ul>
<li><a href="https://sonictk.github.io/asm_tutorial/">Understanding Windows x64 Assembly</a></li>
</ul>  <footer> <a href="https://tdtc-hrb.github.io/blog-frontend">blog-frontend</a> <a href="https://tdtc-hrb.github.io/com-vc">com-vc</a> <a href="https://tdtc-hrb.github.io/css-tws">css-tws</a> <a href="https://tdtc-hrb.github.io/ops-win">ops-win</a> </footer> </body></html>