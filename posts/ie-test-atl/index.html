<!DOCTYPE html><html lang="en"> <head><meta charset="utf-8"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="viewport" content="width=device-width"><meta name="generator" content="Astro v5.4.2"><title>使用Internet Explorer测试COM</title></head> <body> <h1>使用Internet Explorer测试COM</h1>  <p><em>IE6 ~ IE11</em></p> <p>2025-01-19</p> <p>Written by: tdtc</p> <ul>
<li>Target<br>
x86</li>
</ul>
<p><a href="https://tdtc-hrb.github.io/csdn/post/com-wizards-vc/">创建COM</a> 中 增加对IE支持： IObjectWithSite</p>
<!-- VS2010: https://github.com/tdtc-hrb/csdn/raw/master/images/20140420153532328.png -->
<p><img src="https://github.com/tdtc-hrb/csdn/raw/master/images/atl-simple4.png" alt="atl simple object - Support"></p>
<h2 id="增加方法">增加方法</h2>
<!-- VS2010: https://github.com/tdtc-hrb/csdn/raw/master/images/20140420160424359.png -->
<p><img src="https://github.com/tdtc-hrb/csdn/raw/master/images/atl-interface3.png" alt="atl interface - list">
testSOW.h:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>	STDMETHOD(Add)(LONG x, LONG y, LONG* ret);</span></span>
<span class="line"><span>	STDMETHOD(Sub)(LONG x, LONG y, LONG* ret);</span></span>
<span class="line"><span>	STDMETHOD(Mul)(LONG x, LONG y, LONG* ret);</span></span>
<span class="line"><span>	STDMETHOD(Div)(LONG x, LONG y, LONG* ret);</span></span>
<span class="line"><span>	STDMETHOD(Mod)(LONG x, LONG y, LONG* ret);</span></span>
<span class="line"><span>	STDMETHOD(Lg)(LONG x, LONG y, DOUBLE* ret);</span></span></code></pre>
<h3 id="add">Add</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="c"><code><span class="line"><span style="color:#E1E4E8">STDMETHODIMP CtestSOW::</span><span style="color:#B392F0">Add</span><span style="color:#E1E4E8">(LONG </span><span style="color:#FFAB70">x</span><span style="color:#E1E4E8">, LONG </span><span style="color:#FFAB70">y</span><span style="color:#E1E4E8">, LONG</span><span style="color:#F97583">*</span><span style="color:#FFAB70"> ret</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">{</span></span>
<span class="line"><span style="color:#6A737D">	// TODO: Add your implementation code here</span></span>
<span class="line"><span style="color:#F97583">	*</span><span style="color:#E1E4E8">ret </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> (x </span><span style="color:#F97583">+</span><span style="color:#E1E4E8"> y);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">	return</span><span style="color:#E1E4E8"> S_OK;</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<h3 id="subtract">Subtract</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="c"><code><span class="line"><span style="color:#E1E4E8">STDMETHODIMP CtestSOW::</span><span style="color:#B392F0">Sub</span><span style="color:#E1E4E8">(LONG </span><span style="color:#FFAB70">x</span><span style="color:#E1E4E8">, LONG </span><span style="color:#FFAB70">y</span><span style="color:#E1E4E8">, LONG</span><span style="color:#F97583">*</span><span style="color:#FFAB70"> ret</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">{</span></span>
<span class="line"><span style="color:#6A737D">	// TODO: Add your implementation code here</span></span>
<span class="line"><span style="color:#F97583">	*</span><span style="color:#E1E4E8">ret </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> (x </span><span style="color:#F97583">-</span><span style="color:#E1E4E8"> y);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">	return</span><span style="color:#E1E4E8"> S_OK;</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<h3 id="multiply">Multiply</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="c"><code><span class="line"><span style="color:#E1E4E8">STDMETHODIMP CtestSOW::</span><span style="color:#B392F0">Mul</span><span style="color:#E1E4E8">(LONG </span><span style="color:#FFAB70">x</span><span style="color:#E1E4E8">, LONG </span><span style="color:#FFAB70">y</span><span style="color:#E1E4E8">, LONG</span><span style="color:#F97583">*</span><span style="color:#FFAB70"> ret</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">{</span></span>
<span class="line"><span style="color:#6A737D">	// TODO: Add your implementation code here</span></span>
<span class="line"><span style="color:#F97583">	*</span><span style="color:#E1E4E8">ret </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> (x </span><span style="color:#F97583">*</span><span style="color:#E1E4E8"> y);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">	return</span><span style="color:#E1E4E8"> S_OK;</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<h3 id="divide">Divide</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="c"><code><span class="line"><span style="color:#E1E4E8">STDMETHODIMP CtestSOW::</span><span style="color:#B392F0">Div</span><span style="color:#E1E4E8">(LONG </span><span style="color:#FFAB70">x</span><span style="color:#E1E4E8">, LONG </span><span style="color:#FFAB70">y</span><span style="color:#E1E4E8">, LONG</span><span style="color:#F97583">*</span><span style="color:#FFAB70"> ret</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">{</span></span>
<span class="line"><span style="color:#6A737D">	// TODO: Add your implementation code here</span></span>
<span class="line"><span style="color:#F97583">	*</span><span style="color:#E1E4E8">ret </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> (x </span><span style="color:#F97583">/</span><span style="color:#E1E4E8"> y);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">	return</span><span style="color:#E1E4E8"> S_OK;</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<h3 id="modulo">Modulo</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="c"><code><span class="line"><span style="color:#E1E4E8">STDMETHODIMP CtestSOW::</span><span style="color:#B392F0">Mod</span><span style="color:#E1E4E8">(LONG </span><span style="color:#FFAB70">x</span><span style="color:#E1E4E8">, LONG </span><span style="color:#FFAB70">y</span><span style="color:#E1E4E8">, LONG</span><span style="color:#F97583">*</span><span style="color:#FFAB70"> ret</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">{</span></span>
<span class="line"><span style="color:#6A737D">	// TODO: Add your implementation code here</span></span>
<span class="line"><span style="color:#F97583">	*</span><span style="color:#E1E4E8">ret </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> (x </span><span style="color:#F97583">%</span><span style="color:#E1E4E8"> y);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">	return</span><span style="color:#E1E4E8"> S_OK;</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<h3 id="logarithm">Logarithm</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>STDMETHODIMP CtestSOW::Lg(LONG x, LONG y, DOUBLE* ret)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>	// https://en.cppreference.com/w/c/numeric/math/log</span></span>
<span class="line"><span>	*ret = log(x) / log(y);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>	return S_OK;</span></span>
<span class="line"><span>}</span></span></code></pre>
<h2 id="测试">测试</h2>
<ul>
<li>IE</li>
<li>non-IE</li>
</ul>
<h3 id="ie">IE</h3>
<p>[ActiveXObject](<a href="https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-studio-2010/6958xykx(v=vs.100)">https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-studio-2010/6958xykx(v=vs.100)</a>:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="c"><code><span class="line"><span style="color:#E1E4E8">function </span><span style="color:#B392F0">ActiveXObject</span><span style="color:#E1E4E8">(ProgID : String [, location : String])</span></span></code></pre>
<h4 id="activexobject">ActiveXObject</h4>
<ul>
<li>ProgID<br>
<img src="https://github.com/tdtc-hrb/csdn/raw/master/images/20140420162849875.png" alt="code ui"></li>
</ul>
<blockquote>
<p>必选。</p>
</blockquote>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>serverName.typeName</span></span></code></pre>
<p>其中 serverName 是提供对象的应用程序的名称，
typeName 是要创建的对象的类型或类。</p>
<ul>
<li>location</li>
</ul>
<blockquote>
<p>可选项。</p>
</blockquote>
<p>要在其中创建对象的网络访问器的名称。</p>
<h4 id="testatlhtml">testatl.html</h4>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="html"><code><span class="line"><span style="color:#E1E4E8">&#x3C;!</span><span style="color:#85E89D">DOCTYPE</span><span style="color:#B392F0"> html</span><span style="color:#B392F0"> PUBLIC</span><span style="color:#9ECBFF"> "-//W3C//DTD XHTML 1.0 Transitional//EN"</span><span style="color:#9ECBFF"> "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;</span><span style="color:#85E89D">html</span><span style="color:#B392F0"> xmlns</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"http://www.w3.org/1999/xhtml"</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;</span><span style="color:#85E89D">head</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;</span><span style="color:#85E89D">meta</span><span style="color:#B392F0"> http-equiv</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"Content-Type"</span><span style="color:#B392F0"> content</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"text/html; charset=utf-8"</span><span style="color:#E1E4E8"> /></span></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;</span><span style="color:#85E89D">title</span><span style="color:#E1E4E8">>调用ATL方法 - 测试网页&#x3C;/</span><span style="color:#85E89D">title</span><span style="color:#E1E4E8">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;/</span><span style="color:#85E89D">head</span><span style="color:#E1E4E8">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;</span><span style="color:#85E89D">body</span><span style="color:#E1E4E8">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">数     值A：&#x3C;</span><span style="color:#85E89D">input</span><span style="color:#B392F0"> type</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"text"</span><span style="color:#B392F0"> id</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"edtA"</span><span style="color:#E1E4E8"> /></span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#E1E4E8">数     值B：&#x3C;</span><span style="color:#85E89D">input</span><span style="color:#B392F0"> type</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"text"</span><span style="color:#B392F0"> id</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"edtB"</span><span style="color:#E1E4E8"> /></span></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;</span><span style="color:#85E89D">br</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;</span><span style="color:#85E89D">br</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">计算结果：&#x3C;</span><span style="color:#85E89D">input</span><span style="color:#B392F0"> type</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"text"</span><span style="color:#B392F0"> id</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"edtC"</span><span style="color:#E1E4E8"> /></span></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;</span><span style="color:#85E89D">br</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;</span><span style="color:#85E89D">br</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;</span><span style="color:#85E89D">input</span><span style="color:#B392F0"> type</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"button"</span><span style="color:#B392F0"> id</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"btnAdd"</span><span style="color:#B392F0"> value</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"Add"</span><span style="color:#B392F0"> onClick</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"ATLFun.add(document.getElementById('edtA').value, document.getElementById('edtB').value)"</span><span style="color:#E1E4E8"> /></span></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;</span><span style="color:#85E89D">input</span><span style="color:#B392F0"> type</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"button"</span><span style="color:#B392F0"> id</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"btnMul"</span><span style="color:#B392F0"> value</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"Mul"</span><span style="color:#B392F0"> onClick</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"ATLFun.mul(document.getElementById('edtA').value, document.getElementById('edtB').value)"</span><span style="color:#E1E4E8"> /></span></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;</span><span style="color:#85E89D">input</span><span style="color:#B392F0"> type</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"button"</span><span style="color:#B392F0"> id</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"btnDiv"</span><span style="color:#B392F0"> value</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"Div"</span><span style="color:#B392F0"> onClick</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"ATLFun.div(document.getElementById('edtA').value, document.getElementById('edtB').value)"</span><span style="color:#E1E4E8"> /></span></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;</span><span style="color:#85E89D">input</span><span style="color:#B392F0"> type</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"button"</span><span style="color:#B392F0"> id</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"btnSub"</span><span style="color:#B392F0"> value</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"Sub"</span><span style="color:#B392F0"> onClick</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"ATLFun.sub(document.getElementById('edtA').value, document.getElementById('edtB').value)"</span><span style="color:#E1E4E8"> /></span></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;</span><span style="color:#85E89D">input</span><span style="color:#B392F0"> type</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"button"</span><span style="color:#B392F0"> id</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"btnSub"</span><span style="color:#B392F0"> value</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"Mod"</span><span style="color:#B392F0"> onClick</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"ATLFun.mod(document.getElementById('edtA').value, document.getElementById('edtB').value)"</span><span style="color:#E1E4E8"> /></span></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;</span><span style="color:#85E89D">input</span><span style="color:#B392F0"> type</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"button"</span><span style="color:#B392F0"> id</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"btnSub"</span><span style="color:#B392F0"> value</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"base-5"</span><span style="color:#B392F0"> onClick</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"ATLFun.lg(document.getElementById('edtA').value, document.getElementById('edtB').value)"</span><span style="color:#E1E4E8"> /></span></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;/</span><span style="color:#85E89D">body</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;</span><span style="color:#85E89D">script</span><span style="color:#B392F0"> type</span><span style="color:#E1E4E8">=</span><span style="color:#9ECBFF">"text/javascript"</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#F97583">    var</span><span style="color:#E1E4E8"> ATLFun </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">        };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">    ATLFun.</span><span style="color:#B392F0">getObj</span><span style="color:#F97583"> =</span><span style="color:#F97583"> function</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">objName</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#F97583">        return</span><span style="color:#F97583"> new</span><span style="color:#B392F0"> ActiveXObject</span><span style="color:#E1E4E8">(objName);</span></span>
<span class="line"><span style="color:#E1E4E8">    };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">    ATLFun.</span><span style="color:#B392F0">add</span><span style="color:#F97583"> =</span><span style="color:#F97583"> function</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">x</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">y</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#F97583">        var</span><span style="color:#E1E4E8"> obj </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ATLFun.</span><span style="color:#B392F0">getObj</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"testATL.testSOW"</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#F97583">        var</span><span style="color:#E1E4E8"> edtC </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> document.</span><span style="color:#B392F0">getElementById</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"edtC"</span><span style="color:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#E1E4E8"> (obj </span><span style="color:#F97583">!=</span><span style="color:#79B8FF"> null</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">            edtC.value </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> obj.</span><span style="color:#B392F0">Add</span><span style="color:#E1E4E8">(x, y);</span></span>
<span class="line"><span style="color:#E1E4E8">    };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">    ATLFun.</span><span style="color:#B392F0">mul</span><span style="color:#F97583"> =</span><span style="color:#F97583"> function</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">x</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">y</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#F97583">        var</span><span style="color:#E1E4E8"> obj </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ATLFun.</span><span style="color:#B392F0">getObj</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"testATL.testSOW"</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#F97583">        var</span><span style="color:#E1E4E8"> edtC </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> document.</span><span style="color:#B392F0">getElementById</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"edtC"</span><span style="color:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#E1E4E8"> (obj </span><span style="color:#F97583">!=</span><span style="color:#79B8FF"> null</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">            edtC.value </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> obj.</span><span style="color:#B392F0">Mul</span><span style="color:#E1E4E8">(x, y);</span></span>
<span class="line"><span style="color:#E1E4E8">    };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">    ATLFun.</span><span style="color:#B392F0">div</span><span style="color:#F97583"> =</span><span style="color:#F97583"> function</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">x</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">y</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#F97583">        var</span><span style="color:#E1E4E8"> obj </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ATLFun.</span><span style="color:#B392F0">getObj</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"testATL.testSOW"</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#F97583">        var</span><span style="color:#E1E4E8"> edtC </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> document.</span><span style="color:#B392F0">getElementById</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"edtC"</span><span style="color:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#E1E4E8"> (obj </span><span style="color:#F97583">!=</span><span style="color:#79B8FF"> null</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">            edtC.value </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> obj.</span><span style="color:#B392F0">Div</span><span style="color:#E1E4E8">(x, y);</span></span>
<span class="line"><span style="color:#E1E4E8">    };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">    ATLFun.</span><span style="color:#B392F0">sub</span><span style="color:#F97583"> =</span><span style="color:#F97583"> function</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">x</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">y</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#F97583">        var</span><span style="color:#E1E4E8"> obj </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ATLFun.</span><span style="color:#B392F0">getObj</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"testATL.testSOW"</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#F97583">        var</span><span style="color:#E1E4E8"> edtC </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> document.</span><span style="color:#B392F0">getElementById</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"edtC"</span><span style="color:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#E1E4E8"> (obj </span><span style="color:#F97583">!=</span><span style="color:#79B8FF"> null</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">            edtC.value </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> obj.</span><span style="color:#B392F0">Sub</span><span style="color:#E1E4E8">(x, y);</span></span>
<span class="line"><span style="color:#E1E4E8">    };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">    ATLFun.</span><span style="color:#B392F0">mod</span><span style="color:#F97583"> =</span><span style="color:#F97583"> function</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">x</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">y</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#F97583">        var</span><span style="color:#E1E4E8"> obj </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ATLFun.</span><span style="color:#B392F0">getObj</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"testATL.testSOW"</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#F97583">        var</span><span style="color:#E1E4E8"> edtC </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> document.</span><span style="color:#B392F0">getElementById</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"edtC"</span><span style="color:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#E1E4E8"> (obj </span><span style="color:#F97583">!=</span><span style="color:#79B8FF"> null</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">            edtC.value </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> obj.</span><span style="color:#B392F0">Mod</span><span style="color:#E1E4E8">(x, y);</span></span>
<span class="line"><span style="color:#E1E4E8">    };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">    ATLFun.</span><span style="color:#B392F0">lg</span><span style="color:#F97583"> =</span><span style="color:#F97583"> function</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">x</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">y</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#F97583">        var</span><span style="color:#E1E4E8"> obj </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ATLFun.</span><span style="color:#B392F0">getObj</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"testATL.testSOW"</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#F97583">        var</span><span style="color:#E1E4E8"> edtC </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> document.</span><span style="color:#B392F0">getElementById</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"edtC"</span><span style="color:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#E1E4E8"> (obj </span><span style="color:#F97583">!=</span><span style="color:#79B8FF"> null</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">            edtC.value </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> obj.</span><span style="color:#B392F0">Lg</span><span style="color:#E1E4E8">(x, y);</span></span>
<span class="line"><span style="color:#E1E4E8">    };</span></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;/</span><span style="color:#85E89D">script</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;/</span><span style="color:#85E89D">html</span><span style="color:#E1E4E8">></span></span></code></pre>
<h4 id="allow-activex">allow ActiveX</h4>
<!-- ie8: https://github.com/tdtc-hrb/csdn/raw/master/images/20140420162140156.png -->
<!-- ie8: https://github.com/tdtc-hrb/csdn/raw/master/images/20140420162309062.png -->
<!-- ie8: https://github.com/tdtc-hrb/csdn/raw/master/images/20140420162513531.png -->
<!-- ie8: https://github.com/tdtc-hrb/csdn/raw/master/images/20140420162549156.png -->
<p><img src="https://github.com/tdtc-hrb/csdn/raw/master/images/atl-allow-ie1.png" alt="ie11 allow blocked content">
<img src="https://github.com/tdtc-hrb/csdn/raw/master/images/atl-allow-ie2.png" alt="ie11 allow interaction"></p>
<h3 id="non-ie">non-IE</h3>
<ul>
<li><a href="https://www.codeproject.com/Articles/3365/Embed-an-HTML-control-in-your-own-window-using-pla">VC</a></li>
<li>GCC(msys2)<br>
Unzip cpp-mshtml(gcc).zip and execute DisplayHTML.exe:</li>
</ul>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="cmd"><code><span class="line"><span style="color:#E1E4E8">DisplayHTML.exe file://c:/users/xb/documents/testatl.html</span></span></code></pre>
<h4 id="embed-an-html-control-in-your-own-window-using-plain-c---vc">Embed an HTML control in your own window using plain C - VC</h4>
<p>The Simple directory contains a complete C example with everything in one source file.<br>
Study this to familiarize yourself with the technique of using the browser object in your own window.<br>
It demonstrates how to display either an HTML file on the web or disk, or an HTML string in memory, and creates 2 windows to do such.</p>
<ul>
<li>Simple.c<br>
Ln1676~Ln1687:</li>
</ul>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="c"><code><span class="line"><span style="color:#6A737D">		// Create another window with another browser object embedded in it.</span></span>
<span class="line"><span style="color:#F97583">		if</span><span style="color:#E1E4E8"> ((msg.hwnd </span><span style="color:#F97583">=</span><span style="color:#B392F0"> CreateWindowEx</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">&#x26;</span><span style="color:#FFAB70">ClassName</span><span style="color:#E1E4E8">[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">], </span><span style="color:#9ECBFF">"test atl"</span><span style="color:#E1E4E8">, WS_OVERLAPPEDWINDOW,</span></span>
<span class="line"><span style="color:#E1E4E8">						CW_USEDEFAULT, </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, CW_USEDEFAULT, </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">						HWND_DESKTOP, </span><span style="color:#79B8FF">NULL</span><span style="color:#E1E4E8">, hInstance, </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">)))</span></span>
<span class="line"><span style="color:#E1E4E8">		{</span></span>
<span class="line"><span style="color:#6A737D">			// For this window, display a URL. This could also be a HTML file on disk such as "c:\\myfile.htm".</span></span>
<span class="line"><span style="color:#B392F0">			DisplayHTMLPage</span><span style="color:#E1E4E8">(msg.hwnd, </span><span style="color:#9ECBFF">"c:</span><span style="color:#79B8FF">\\</span><span style="color:#9ECBFF">users</span><span style="color:#79B8FF">\\</span><span style="color:#9ECBFF">xb</span><span style="color:#79B8FF">\\</span><span style="color:#9ECBFF">documents</span><span style="color:#79B8FF">\\</span><span style="color:#9ECBFF">testatl.html"</span><span style="color:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">			// Show the window.</span></span>
<span class="line"><span style="color:#B392F0">			ShowWindow</span><span style="color:#E1E4E8">(msg.hwnd, nCmdShow);</span></span>
<span class="line"><span style="color:#B392F0">			UpdateWindow</span><span style="color:#E1E4E8">(msg.hwnd);</span></span>
<span class="line"><span style="color:#E1E4E8">		}</span></span></code></pre>
<p>Note!!!: 原来的文件名称已经变更为 Simple1.c</p>
<p>file name: cwebpage_src(vc141).zip</p>
<h3 id="attachment">attachment</h3>
<!-- testATL.7z(vc10): https://pan.baidu.com/s/1VFaDUD1AYmGHIeyg7wplhA  提取码: xysa -->
<!-- testATL(vc142).zip: https://pan.baidu.com/s/1lPI_sVBYQqh2-xfa_xVHHg?pwd=n2vk -->
<ul>
<li><a href="https://pan.baidu.com/s/1eATNR3x404qYBnHDtTGzag?pwd=cm5i">testATL(vc140).zip</a></li>
<li><a href="https://pan.baidu.com/s/1mnn875af_vfvQg6hKzSicQ?pwd=4yh3">cwebpage_src(vc141).zip</a></li>
<li><a href="https://pan.baidu.com/s/1zQtLSKT8C0sZ2THdIPrWxw?pwd=aqke">cpp-mshtml(gcc).zip</a></li>
</ul>  <a href="https://tdtc-hrb.github.io/com-vc">Back to Home</a> </body></html>