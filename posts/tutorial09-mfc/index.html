<!DOCTYPE html><html lang="en"> <head><meta charset="utf-8"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="viewport" content="width=device-width"><meta name="generator" content="Astro v5.15.3"><title>Combo-box - Controls</title></head> <body> <h1>Combo-box - Controls</h1>  <p><em>Provides the functionality of a Windows combo box.</em></p> <p>2025-11-02</p> <p>Written by: xiaobin</p> <p>Place two combo box controls:</p>
<ul>
<li>m_strPortNum</li>
<li>IDC_COMBO1Timer</li>
</ul>
<h3 id="list-creation">List Creation</h3>
<ul>
<li>data propertie<br>
Right-click the combo box, select Properties, and enter the following in the DATA field:</li>
</ul>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>500;1000;2000;</span></span></code></pre>
<ul>
<li>Control initial events<br>
for example: OnInitialUpdate() or OnInitDialog(). etc…</li>
</ul>
<h4 id="oninitialupdate">OnInitialUpdate()</h4>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>void CSerialCommView::OnInitialUpdate()</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>    CFormView::OnInitialUpdate();</span></span>
<span class="line"><span>    GetParentFrame()->RecalcLayout();</span></span>
<span class="line"><span>    ResizeParentToFit();</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    // Add String</span></span>
<span class="line"><span>    CArray&#x3C;SSerInfo,SSerInfo&#x26;> asi;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    // Populate the list of serial ports.</span></span>
<span class="line"><span>    EnumSerialPorts(asi,FALSE/*include all*/);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    for (int ii = 0; ii&#x3C; asi.GetSize(); ii++) {</span></span>
<span class="line"><span>        m_strPortNum.AddString(asi[ii].strFriendlyName);</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>}</span></span></code></pre>
<h3 id="the-selected-string">The Selected String</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>    CString strTemp;</span></span>
<span class="line"><span>    int nCurSel;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    nCurSel = ((CComboBox *) GetDlgItem(IDC_COMBO1Timer))->GetCurSel();</span></span>
<span class="line"><span>    ((CComboBox *) GetDlgItem(IDC_COMBO1Timer))->GetLBText(nCurSel, strTemp);</span></span></code></pre>
<h2 id="breaking-changes">Breaking changes</h2>
<p><a href="https://www.functionx.com/visualc/controls/combobox1.htm">MFC Combo Boxes</a>,
<a href="https://www.functionx.com/visualc/samples/comboexo.exe">Download</a> and after extraction；
Move the following files:</p>
<ul>
<li>ComboExo.ico</li>
<li>ComboExo.rc2<br>
to the “res” directory.</li>
</ul>
<h3 id="ide-update-issues">ide update issues</h3>
<p>When using VS2015+,</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>D8016 '/ZI' and '/Gy-' command-line options are incompatible</span></span></code></pre>
<ul>
<li><a href="https://stackoverflow.com/a/44462055">VC6.0 issue</a></li>
</ul>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>Program Database(/Zi)</span></span></code></pre>
<p>C/C++ -> General -> Debug Information Format</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>Yes(/Gy)</span></span></code></pre>
<p>C/C++ -> Code Generation -> Enable Function-Level Linking</p>
<h2 id="ref">Ref</h2>
<ul>
<li><a href="https://learn.microsoft.com/en-us/cpp/mfc/reference/ccombobox-class?view=msvc-170#example">AddString()</a></li>
<li><a href="https://learn.microsoft.com/en-us/cpp/mfc/reference/ccombobox-class?view=msvc-170#getcursel">GetCurSel()</a></li>
<li><a href="https://learn.microsoft.com/en-us/cpp/mfc/reference/ccombobox-class?view=msvc-170#getlbtext">GetLBText()</a></li>
</ul>  <footer> <a href="https://tdtc-hrb.github.io/blog-frontend">blog-frontend</a> <a href="https://tdtc-hrb.github.io/com-vc">com-vc</a> <a href="https://tdtc-hrb.github.io/css-tws">css-tws</a> <a href="https://tdtc-hrb.github.io/ops-win">ops-win</a> </footer> </body></html>