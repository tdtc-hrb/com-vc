<!DOCTYPE html><html lang="en"> <head><meta charset="utf-8"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="viewport" content="width=device-width"><meta name="generator" content="Astro v5.15.7"><title>Combo-box Control - ComboExo example</title></head> <body> <h1>Combo-box Control - ComboExo example</h1>  <p><em>Create a new ComboExo using VS2013</em></p> <p>2025-11-04</p> <p>Written by: xiaobin</p> <ul>
<li>MFC Application Wizard</li>
<li>design dialog</li>
<li>event</li>
</ul>
<h3 id="comboexo-example---visualc"><a href="https://www.functionx.com/visualc/controls/combobox1.htm">ComboExo example - visualc</a></h3>
<p>The original <a href="https://www.functionx.com/visualc/samples/comboexo.exe">example</a> was written using VC6.0; now we will rewrite it using VS2013.
After downloading, click “Extract” to extract the source files.</p>
<p>Move files to the “res” directory:</p>
<ul>
<li>res/ComboExo.ico</li>
<li>res/ComboExo.rc2</li>
</ul>
<h4 id="recompile-with-visual-studio-2015"><a href="https://stackoverflow.com/a/44462055">Recompile with Visual Studio 2015+</a></h4>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>D8016 '/ZI' and '/Gy-' command-line options are incompatible</span></span></code></pre>
<p>C/C++ -> General -> Debug Information Format</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>Program Database(/Zi)</span></span></code></pre>
<h2 id="mfc-application-wizard">MFC Application Wizard</h2>
<ul>
<li><a href="https://learn.microsoft.com/en-us/cpp/mfc/reference/application-type-mfc-application-wizard">Application Type</a></li>
<li><a href="https://learn.microsoft.com/en-us/cpp/mfc/reference/user-interface-features-mfc-application-wizard">User Interface Features</a></li>
</ul>
<blockquote>
<p>default</p>
</blockquote>
<ul>
<li><a href="https://learn.microsoft.com/en-us/cpp/mfc/reference/advanced-features-mfc-application-wizard">Advanced Features</a></li>
</ul>
<blockquote>
<p>Cancel All</p>
</blockquote>
<h3 id="application-type---dialog-based">Application Type - Dialog based</h3>
<ul>
<li>Project style:</li>
</ul>
<blockquote>
<p>MFC standard</p>
</blockquote>
<ul>
<li>Dialog based options:</li>
</ul>
<blockquote>
<p>none</p>
</blockquote>
<h2 id="design-dialog">design dialog</h2>
<p>Drag and drop from the toolbox:</p>
<ul>
<li>Combo box</li>
<li>Edit Control</li>
</ul>
<h3 id="list-height">List height</h3>
<p>There are two ways to adjust the list height:</p>
<ol>
<li><a href="https://stackoverflow.com/a/2513306">Drag the “down arrow”</a>
<img src="https://github.com/tdtc-hrb/csdn/raw/master/images/MFCApplication1-combobox.png" alt="down arrow"></li>
<li><a href="https://stackoverflow.com/a/6095864">Configure the rc file</a><br>
Original data:</li>
</ol>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>COMBOBOX        IDC_COMBO1,58,39,48,30,CBS_DROPDOWN | CBS_SORT | WS_VSCROLL | WS_TABSTOP</span></span></code></pre>
<p>new data: Height of the 4 items</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>COMBOBOX        IDC_COMBO1,58,39,48,48,CBS_DROPDOWN | CBS_SORT | WS_VSCROLL | WS_TABSTOP</span></span></code></pre>
<h2 id="event">event</h2>
<ul>
<li>CBN_SELCHANGE</li>
</ul>
<blockquote>
<p>IDC_COMBO1 -> Properties</p>
</blockquote>
<ul>
<li>OnInitXXX</li>
</ul>
<h3 id="cbn_selchange">CBN_SELCHANGE</h3>
<p>Click the “CBN_SELCHANGE” event property and select ”<add> OnCbnSelchangeCombo1” from the drop-down menu.
<img src="https://github.com/tdtc-hrb/csdn/raw/master/images/MFCApplication1-combobox1.png" alt="Sent when the user changes the current selection in the list box of a combo box"></add></p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>void CComboExoDlg::OnCbnSelchangeCombo1()</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>    // TODO: Add your control notification handler code here</span></span>
<span class="line"><span>    CString strTemp;</span></span>
<span class="line"><span>    int nCurSel;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    nCurSel = ((CComboBox*)GetDlgItem(IDC_COMBO1))->GetCurSel();</span></span>
<span class="line"><span>    ((CComboBox*)GetDlgItem(IDC_COMBO1))->GetLBText(nCurSel, strTemp);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    GetDlgItem(IDC_EDIT1)->SetWindowText(strTemp);</span></span>
<span class="line"><span>}</span></span></code></pre>
<h3 id="oninitdialog">OnInitDialog()</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>// Add 20 items to the combo box.</span></span>
<span class="line"><span>CString str;</span></span>
<span class="line"><span>for (int i = 0; i &#x3C; 20; i++)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>    str.Format(_T("item string %d"), i);</span></span>
<span class="line"><span>    ((CComboBox*)GetDlgItem(IDC_COMBO1))->AddString(str);</span></span>
<span class="line"><span>}</span></span></code></pre>  <footer> <a href="https://tdtc-hrb.github.io/blog-frontend">blog-frontend</a> <a href="https://tdtc-hrb.github.io/com-vc">com-vc</a> <a href="https://tdtc-hrb.github.io/css-tws">css-tws</a> <a href="https://tdtc-hrb.github.io/ops-win">ops-win</a> </footer> </body></html>