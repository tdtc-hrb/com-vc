<!DOCTYPE html><html lang="en"> <head><meta charset="utf-8"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="viewport" content="width=device-width"><meta name="generator" content="Astro v5.15.4"><title>Collection Serialization</title></head> <body> <h1>Collection Serialization</h1>  <p><em>database connection string</em></p> <p>2025-11-10</p> <p>Written by: xiaobin</p> <h3 id="usage-collection-serialization">Usage Collection Serialization</h3>
<p>first declare a member variable of type CObArray.</p>
<p>To serialize a CObArray collection in your project,
all of you have to do is to call the CObArray::Serialize() member function.
Everything else would be handled behind the scenes.</p>
<h4 id="define">define</h4>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>private:</span></span>
<span class="line"><span>    CObArray ListOfConnStrings;</span></span></code></pre>
<h4 id="impl">impl</h4>
<p>On the main menu, click Project -> Class Wizardâ€¦<br>
In the Class Name, make sure CMFCApplication1Dlg is selected.<br>
Click the Virtual Functions tab<br>
In the Virtual Functions list, scroll down and double-click Serialize<br>
Click Edit Code and implement the member function as follows:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>void CMFCApplication1Dlg::Serialize(CArchive &#x26;ar)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>    if (ar.IsStoring())</span></span>
<span class="line"><span>    {   // storing code</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>    else</span></span>
<span class="line"><span>    {   // loading code</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>    ListOfConnStrings.Serialize(ar);</span></span>
<span class="line"><span>}</span></span></code></pre>
<h2 id="project">project</h2>
<ul>
<li>Editor</li>
<li>Event</li>
</ul>
<h3 id="editor">Editor</h3>

































<table><thead><tr><th>Server</th><th>DB</th><th>User</th><th>Pwd</th><th>Type</th></tr></thead><tbody><tr><td>.</td><td>c:\fde.mdb</td><td>admin</td><td>wwsrts12</td><td>MS-Access</td></tr><tr><td>serverdb</td><td>pubs</td><td>sa</td><td>qwerty</td><td>MSSQL</td></tr><tr><td>192.168.1.107</td><td>employees</td><td>DBA</td><td>xb12345</td><td>MySQL</td></tr></tbody></table>
<h4 id="add-dialog">add dialog</h4>
<p><img src="https://github.com/tdtc-hrb/csdn/raw/master/images/dialog_bar-res.png" alt="IDC_DIALOGBAR"></p>
<p>and set:</p>
<ul>
<li>Style: Popup</li>
<li>System Menu: True</li>
<li>Title Bar: True</li>
</ul>
<h4 id="add-class">add class</h4>
<p><img src="https://github.com/tdtc-hrb/csdn/raw/master/images/add_class1-ctl.png" alt="Add a class from the control"></p>
<h4 id="add-variable"><a href="https://tdtc-hrb.github.io/com-vc/posts/tutorial14-mfc">Add Variable</a></h4>
<h3 id="event">event</h3>
<p>Add event handlers to the main dialog box.</p>
<h4 id="new">New</h4>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>    int iCurSel = 0;</span></span>
<span class="line"><span>    iCurSel = m_Types.GetCurSel();</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    CConnEditorDlg dlg;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    if (dlg.DoModal() == IDOK)</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>        CConnectString *connStr = new CConnectString(dlg.m_Server,</span></span>
<span class="line"><span>            dlg.m_Db, dlg.m_User,</span></span>
<span class="line"><span>            dlg.m_Pwd, iCurSel);</span></span>
<span class="line"><span>        // Add that new connect string to the collection</span></span>
<span class="line"><span>        ListOfConnStrings.Add(connStr);</span></span>
<span class="line"><span>    }</span></span></code></pre>
<h4 id="save">Save</h4>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>    CFile fileConnStrs;</span></span>
<span class="line"><span>    CString strFilename = _T("conns.str");</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    fileConnStrs.Open(strFilename, CFile::modeCreate | CFile::modeWrite);</span></span>
<span class="line"><span>    CArchive arc(&#x26;fileConnStrs, CArchive::store);</span></span>
<span class="line"><span>    Serialize(arc);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    arc.Close();</span></span>
<span class="line"><span>    fileConnStrs.Close();</span></span></code></pre>
<h2 id="ref">Ref</h2>
<ul>
<li><a href="https://www.functionx.com/visualc/fileprocessing/serialization.htm">Fundamentals of Serialization</a></li>
<li><a href="https://tdtc-hrb.github.io/com-vc/posts/tutorial12-mfc">Serialization class</a></li>
<li><a href="https://mega.nz/file/aQE3FQpY#JarPutLeKjGr-Q66wqgkKEL7CGpCrMSLMa-DOBzlZao">CollSerialDemo.zip</a></li>
</ul>  <footer> <a href="https://tdtc-hrb.github.io/blog-frontend">blog-frontend</a> <a href="https://tdtc-hrb.github.io/com-vc">com-vc</a> <a href="https://tdtc-hrb.github.io/css-tws">css-tws</a> <a href="https://tdtc-hrb.github.io/ops-win">ops-win</a> </footer> </body></html>