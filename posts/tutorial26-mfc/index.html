<!DOCTYPE html><html lang="en"> <head><meta charset="utf-8"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="viewport" content="width=device-width"><meta name="generator" content="Astro v5.15.9"><title>Modify the code generated by the MFC App Wizard to use MFC v4.2 or later</title></head> <body> <h1>Modify the code generated by the MFC App Wizard to use MFC v4.2 or later</h1>  <p><em>Streamline unnecessary code</em></p> <p>2025-11-19</p> <p>Written by: xiaobin</p> <h3 id="msvc-version---add"><a href="https://en.wikipedia.org/wiki/Microsoft_Visual_C%2B%2B">MSVC Version</a> - add</h3>
<p>Add the following before and after each “pragma once”:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>#if _MSC_VER > 1020</span></span>
<span class="line"><span>#pragma once</span></span>
<span class="line"><span>#endif // _MSC_VER > 1020</span></span></code></pre>
<p>Visual C++ 5.0 includes MFC 4.2.</p>
<h4 id="vc5-and-vc6"><a href="http://www.malsmith.net/blog/visual-c-visual-history">VC5 and VC6</a></h4>
<p>Visual C++ 6 was a small update to Visual C++ 5 in terms of both UI and functionality.
The biggest change that I observed was having an install time check for Internet Explorer 4 and moving the documentation system to HTML Help.
This check was looking at the registry only however, and the HTML Help system worked (albeit without perfect CSS formatting) with Internet Explorer 3.</p>
<p>Under the covers, the dependency on Internet Explorer 4 was also problematic.
By default the headers would use new structures that are only supported when Internet Explorer 4 was present,
so unless a developer consciously set values like _WIN32_IE themselves, programs generated tended to have an IE4 dependency.</p>
<p>One of the things that made Visual C++ 6 so long lived is it was possible to use an updated Windows SDK, up to Windows 2003 Service Pack 1.
This meant that a developer could use Visual C++ 6 without sacrificing any operating system functionality,
while retaining the benefit of using MSVCRT.DLL.</p>
<h3 id="shared-handlers---removed">Shared Handlers - removed</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>SHARED_HANDLERS can be defined in an ATL project implementing preview, thumbnail </span></span>
<span class="line"><span>and search filter handlers and allows sharing of document code with that project.</span></span></code></pre>
<p>If you don’t use ATL’s thumbnails or other features, you can remove the code within the SHARED_HANDLERS macro.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>#ifdef SHARED_HANDLERS</span></span>
<span class="line"><span>    // some code here</span></span>
<span class="line"><span>#endif // SHARED_HANDLERS</span></span></code></pre>
<p>Included files:</p>
<ul>
<li><projectname>Doc.cpp</projectname></li>
<li><projectname>Doc.h</projectname></li>
<li><projectname>View.cpp</projectname></li>
</ul>
<h4 id="mfc--thumbnail-preview-and-com-dll-with-com-interface"><a href="https://www.ucancode.net/Visual_C_MFC_Samples/Visual-C-2010-Article-MFC-Thumbnail-Preview-Com-DLL-Com-Interface.htm">MFC  Thumbnail Preview and Com DLL with Com Interface</a></h4>
<p>Visual C++ 2010 adds the ability to simply implement Thumbnail and Preview support for Microsoft Foundation Classes (MFC) projects
with a registered file extension. The file extension is a critical part of the Thumbnail and Preview support,
as the COM DLL that handles the rendering of both thumbnails and previews is mapped by file extension.</p>
<h3 id="toolbar-docking---removed">Toolbar docking - removed</h3>
<p>If you do not want the toolbar to be dockable, please delete it:</p>
<ul>
<li>MainFrm.cpp</li>
</ul>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>    // TODO: Delete these three lines if you don't want the toolbar to be dockable</span></span>
<span class="line"><span>    m_wndToolBar.EnableDocking(CBRS_ALIGN_ANY);</span></span>
<span class="line"><span>    EnableDocking(CBRS_ALIGN_ANY);</span></span>
<span class="line"><span>    DockControlBar(&#x26;m_wndToolBar);</span></span></code></pre>
<ul>
<li>MainFrm.h</li>
</ul>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>protected:  // control bar embedded members</span></span>
<span class="line"><span>    CToolBar          m_wndToolBar;</span></span></code></pre>  <footer> <a href="https://tdtc-hrb.github.io/blog-frontend">blog-frontend</a> <a href="https://tdtc-hrb.github.io/com-vc">com-vc</a> <a href="https://tdtc-hrb.github.io/css-tws">css-tws</a> <a href="https://tdtc-hrb.github.io/ops-win">ops-win</a> </footer> </body></html>